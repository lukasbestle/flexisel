/* Flexisel v1.0 (16.02.2014) | (c) Lukas Bestle */
var Flexisel=function(e,f){var m=this,c,h,g,d,k,l,n,p;this.options={interval:8E3,waitAfterManual:2E4,changeTime:400,stage:".stage",listItems:"li",buttons:"a",transfer:"a",stageChangingClass:"changing",activeClass:"active",setCallback:null,noHover:!1,debug:!1};if("object"===typeof f)for(c in f)f.hasOwnProperty(c)&&(this.options[c]=f[c]);g=e.querySelector(this.options.stage);d=Array.prototype.slice.call(e.querySelectorAll(this.options.listItems));c=Array.prototype.slice.call(e.querySelectorAll(this.options.listItems+
(this.options.buttons?" "+this.options.buttons:"")));this.lastManual=this.current=0;this.hovered=!1;this.set=function(a){var b,c;if(0===d.length)return!1;if(void 0===a)b=d[this.current===d.length-1?0:this.current+1];else if("number"===typeof a)b=d[a];else if("object"===typeof a)d.every(function(c){return c===a||p(a,c)?(b=c,!1):!0});else throw'[Flexisel] Invalid value for "newItem".';c=b.querySelector(this.options.transfer);if("function"===typeof this.options.setCallback&&!this.options.setCallback(b)||
d.indexOf(b)===this.current)return!1;d.forEach(function(a){l(a,this.options.activeClass)}.bind(this));k(b,this.options.activeClass);k(g,this.options.stageChangingClass);setTimeout(function(){g.innerHTML=n(c);setTimeout(function(){l(g,this.options.stageChangingClass)}.bind(this),this.options.changeTime/2)}.bind(this),this.options.changeTime/2);this.current=d.indexOf(b);this.options.debug&&console.log("[Flexisel] Changed to item "+this.current+", which was "+(void 0===a?"the next item":"requested")+
".");return!0};h=function(){var a=(new Date).getTime(),a=this.lastManual+this.options.waitAfterManual>a?this.options.waitAfterManual-(a-this.lastManual):0;setTimeout(function(){this.lastManual+this.options.waitAfterManual<=(new Date).getTime()&&!this.hovered&&this.set();setTimeout(h.bind(this),this.options.interval)}.bind(this),a)};setTimeout(h.bind(this),this.options.interval);c.forEach(function(a){a.onclick=function(){if(m.set(this))return m.lastManual=(new Date).getTime(),!1}}.bind(this));this.options.noHover||
(e.onmouseover=function(){this.hovered=!0}.bind(this),e.onmouseout=function(){this.hovered=!1}.bind(this));k=function(a,b){a.className+=(a.className?" ":"")+b};l=function(a,b){a.className=a.className.replace(RegExp("(\\s|^)"+b+"(\\s|$)")," ").replace(/^\s+|\s+$/g,"")};n=function(a){var b;(b=a.outerHTML)||(b=document.createElement("div"),b.appendChild(a.cloneNode(!0)),b=b.innerHTML);return b};p=function(a,b){for(;(a=a.parentNode)&&a!==b;);return!!a}};
